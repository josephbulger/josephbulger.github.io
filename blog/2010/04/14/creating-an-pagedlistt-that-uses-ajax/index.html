
<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>Creating an PagedList<T> that uses AJAX - Joseph Bulger</title>
	<meta name="author" content="Joseph Bulger">

	
	<meta name="description" content="Creating an PagedList That Uses AJAX I’ve been using this PagedList functionality that i found from a blog article Rob Conery put up, and a control &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="Joseph Bulger" type="application/atom+xml">
	
	<link rel="canonical" href="http://josephbulger.com/blog/2010/04/14/creating-an-pagedlistt-that-uses-ajax/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-47917400-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	
	<img src="http://www.gravatar.com/avatar/5db37e04905df77ec0c90dc7faebadfc?s=160" alt="Profile Picture" style="width: 160px;" />
	
</div>
<hgroup>
  <h1><a href="/">Joseph Bulger</a></h1>
  
    <h2>a Dark Matter Developer</h2>
  
</hgroup>

<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
		
			<a class="twitter" href="http://twitter.com/josephbulger" title="Twitter">Twitter</a>
		
		
			<a class="github" href="https://github.com/josephbulger" title="GitHub">GitHub</a>
		
		
		
		
		
		
		
		
		
			<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">Creating an PagedList<T> That Uses AJAX</h1>
	<div class="entry-content" itemprop="articleBody"><p>I’ve been using this PagedList functionality that i found from a <a href="http://blog.wekeroad.com/2007/12/10/aspnet-mvc-pagedlistt/">blog article Rob Conery</a> put up, and <a href="http://code-inside.de/blog-in/2008/04/08/aspnet-mvc-pagination-view-user-control/">a control I found by Robert Muehsig</a> which I’ve really enjoyed using so far.</p>

<p>One of the things that was missing from the functional set that I ended up needing was the ability to page the list, but through issuing AJAX requests instead of the typical post back.</p>

<p>So I went off and extended the existing model to support AJAX requests, and thought I would share it in case anyone else needed to do the same thing.<!-- more --></p>

<p>I guess the best place to start would be the use case.  So to start I created a control that encapsulates the Paging UI layout and calls I need.  The use of the original control looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="n">Html</span><span class="p">.</span><span class="n">RenderPartial</span><span class="p">(</span><span class="s">&quot;AjaxPagination&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="k">new</span> <span class="n">AjaxPaginationViewData</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">PageIndex</span> <span class="p">=</span> <span class="n">Model</span><span class="p">.</span><span class="n">PageIndex</span><span class="p">,</span>
</span><span class='line'>            <span class="n">Action</span> <span class="p">=</span> <span class="s">&quot;CondoPage&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="n">Controller</span> <span class="p">=</span> <span class="s">&quot;Home&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="n">AjaxOptions</span> <span class="p">=</span>
</span><span class='line'>                <span class="k">new</span> <span class="n">AjaxOptions</span> <span class="p">{</span>
</span><span class='line'>                    <span class="n">UpdateTargetId</span> <span class="p">=</span> <span class="s">&quot;updatedContent&quot;</span> <span class="p">},</span>
</span><span class='line'>            <span class="n">TotalCount</span> <span class="p">=</span> <span class="n">Model</span><span class="p">.</span><span class="n">TotalCount</span><span class="p">,</span>
</span><span class='line'>            <span class="n">PageSize</span> <span class="p">=</span> <span class="n">Model</span><span class="p">.</span><span class="n">PageSize</span><span class="p">,</span>
</span><span class='line'>            <span class="n">NumberOfPagesToEachSide</span> <span class="p">=</span> <span class="m">2</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>The new AJAX functionality is called similarly:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="p">&lt;%</span> <span class="k">using</span> <span class="p">(</span><span class="n">Ajax</span><span class="p">.</span><span class="n">BeginForm</span><span class="p">(</span><span class="s">&quot;SomePage&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&quot;SomeController&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="k">new</span> <span class="n">AjaxOptions</span> <span class="p">{</span> <span class="n">UpdateTargetId</span> <span class="p">=</span> <span class="s">&quot;updatedContent&quot;</span> <span class="p">}))</span> <span class="p">{</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">&lt;%</span> <span class="n">Html</span><span class="p">.</span><span class="n">RenderPartial</span><span class="p">(</span><span class="s">&quot;AjaxPagination&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="k">new</span> <span class="n">AjaxPaginationViewData</span> <span class="p">{</span>
</span><span class='line'>                    <span class="n">PageIndex</span> <span class="p">=</span> <span class="n">Model</span><span class="p">.</span><span class="n">PageIndex</span><span class="p">,</span>
</span><span class='line'>                    <span class="n">Action</span> <span class="p">=</span> <span class="s">&quot;SomeAction&quot;</span><span class="p">,</span>
</span><span class='line'>                    <span class="n">Controller</span> <span class="p">=</span> <span class="s">&quot;SomeController&quot;</span><span class="p">,</span>
</span><span class='line'>                    <span class="n">AjaxOptions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">AjaxOptions</span>
</span><span class='line'>                        <span class="p">{</span> <span class="n">UpdateTargetId</span> <span class="p">=</span> <span class="s">&quot;updatedContent&quot;</span> <span class="p">},</span>
</span><span class='line'>                    <span class="n">TotalCount</span> <span class="p">=</span> <span class="n">Model</span><span class="p">.</span><span class="n">TotalCount</span><span class="p">,</span>
</span><span class='line'>                    <span class="n">PageSize</span> <span class="p">=</span> <span class="n">Model</span><span class="p">.</span><span class="n">PageSize</span><span class="p">,</span>
</span><span class='line'>                    <span class="n">NumberOfPagesToEachSide</span> <span class="p">=</span> <span class="m">2</span>
</span><span class='line'>        <span class="p">});%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>A couple things to note. You’ll notice that the AJAX control is rendered inside a Ajax.BeginForm. This is because I’m using the Microsoft.Ajax way of making AJAX calls.  This could also be done using jQuery or something else that can process AJAX calls. I just went this way because the scripts are already included in asp.net mvc app when you first create the project.  The result of the AJAX call will be a partial view, and we’ll need to put that somewhere.  That’s where the UpdatedTargetId comes into play. Other things we include in the AJAX control that are not in the original are the Action and the Controller, and some AjaxOptions. PageActionLink doesn’t work with the AJAX control, because we’ll be using Ajax.ActionLink to build the link, which is why I broke it up into Action, and Controller. For the AjaxOptions, we need those to specify the target of the call.</p>

<p>So now that’s been explained, let’s look at the controls themselves.  Here’s a comparison of the original control and the ajax control.</p>

<p>The original is one this way:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="p">&lt;%</span> <span class="k">if</span> <span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">HasPreviousPage</span><span class="p">)</span> <span class="p">{</span> <span class="p">%&gt;</span>
</span><span class='line'>    <span class="p">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="p">=</span><span class="s">&quot;&lt;%=Model.PageActionLink.Replace(&quot;</span><span class="p">%</span><span class="m">7</span><span class="n">Bpage</span><span class="p">%</span><span class="m">7D</span><span class="s">&quot;, (Model.PageIndex - 1).ToString())%&gt;&quot;</span><span class="p">&gt;</span><span class="n">Previous</span><span class="p">&lt;/</span><span class="n">a</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;%</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span> <span class="k">if</span> <span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">GetFirstPageToLink</span><span class="p">()</span> <span class="p">!=</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span> <span class="p">%&gt;...&lt;%</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span><span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">page</span> <span class="p">=</span> <span class="n">Model</span><span class="p">.</span><span class="n">GetFirstPageToLink</span><span class="p">();</span> <span class="n">page</span> <span class="p">&lt;=</span> <span class="n">Model</span><span class="p">.</span><span class="n">GetLastPageToLink</span><span class="p">();</span> <span class="n">page</span><span class="p">++)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">page</span> <span class="p">==</span> <span class="n">Model</span><span class="p">.</span><span class="n">PageIndex</span><span class="p">)</span> <span class="p">{</span> <span class="p">%&gt;</span>
</span><span class='line'>        <span class="p">&lt;%=</span><span class="n">page</span><span class="p">.</span><span class="n">ToString</span><span class="p">()%&gt;</span>
</span><span class='line'><span class="p">&lt;%</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="p">%&gt;</span>
</span><span class='line'>    <span class="p">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="p">=</span><span class="s">&quot;&lt;%=Model.PageActionLink.Replace(&quot;</span><span class="p">%</span><span class="m">7</span><span class="n">Bpage</span><span class="p">%</span><span class="m">7D</span><span class="s">&quot;, page.ToString())%&gt;&quot;</span><span class="p">&gt;&lt;%=</span><span class="n">page</span><span class="p">.</span><span class="n">ToString</span><span class="p">()%&gt;&lt;/</span><span class="n">a</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;%</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">page</span> <span class="p">!=</span> <span class="n">Model</span><span class="p">.</span><span class="n">GetLastPageToLink</span><span class="p">())</span> <span class="p">{</span> <span class="p">%&gt;|&lt;%</span> <span class="p">}</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span> <span class="k">if</span> <span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">GetLastPageToLink</span><span class="p">()</span> <span class="p">!=</span> <span class="n">Model</span><span class="p">.</span><span class="n">PageCount</span><span class="p">)</span> <span class="p">{</span> <span class="p">%&gt;...&lt;%</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span> <span class="k">if</span> <span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">HasNextPage</span><span class="p">)</span> <span class="p">{</span> <span class="p">%&gt;</span>
</span><span class='line'>    <span class="p">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="p">=</span><span class="s">&quot;&lt;%=Model.PageActionLink.Replace(&quot;</span><span class="p">%</span><span class="m">7</span><span class="n">Bpage</span><span class="p">%</span><span class="m">7D</span><span class="s">&quot;, (Model.PageIndex + 1).ToString())%&gt;&quot;</span><span class="p">&gt;</span><span class="n">Next</span><span class="p">&lt;/</span><span class="n">a</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;%</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And the AJAX control is done this way:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="p">&lt;%</span> <span class="k">if</span> <span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">HasPreviousPage</span><span class="p">)</span> <span class="p">{</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%=</span> <span class="n">Ajax</span><span class="p">.</span><span class="n">ActionLink</span><span class="p">(</span><span class="s">&quot;Previous&quot;</span><span class="p">,</span> <span class="n">Model</span><span class="p">.</span><span class="n">Action</span><span class="p">,</span> <span class="n">Model</span><span class="p">.</span><span class="n">Controller</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">page</span> <span class="p">=</span> <span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">PageIndex</span> <span class="p">-</span> <span class="m">1</span><span class="p">).</span><span class="n">ToString</span><span class="p">()</span> <span class="p">},</span> <span class="n">Model</span><span class="p">.</span><span class="n">AjaxOptions</span><span class="p">)%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span> <span class="k">if</span> <span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">GetFirstPageToLink</span><span class="p">()</span> <span class="p">!=</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span> <span class="p">%&gt;...&lt;%</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span><span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">page</span> <span class="p">=</span> <span class="n">Model</span><span class="p">.</span><span class="n">GetFirstPageToLink</span><span class="p">();</span> <span class="n">page</span> <span class="p">&lt;=</span> <span class="n">Model</span><span class="p">.</span><span class="n">GetLastPageToLink</span><span class="p">();</span> <span class="n">page</span><span class="p">++)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">page</span> <span class="p">==</span> <span class="n">Model</span><span class="p">.</span><span class="n">PageIndex</span><span class="p">)</span> <span class="p">{</span> <span class="p">%&gt;</span>
</span><span class='line'>        <span class="p">&lt;%=</span><span class="n">page</span><span class="p">.</span><span class="n">ToString</span><span class="p">()%&gt;</span>
</span><span class='line'>    <span class="p">&lt;%</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%=</span> <span class="n">Ajax</span><span class="p">.</span><span class="n">ActionLink</span><span class="p">(</span><span class="n">page</span><span class="p">.</span><span class="n">ToString</span><span class="p">(),</span> <span class="n">Model</span><span class="p">.</span><span class="n">Action</span><span class="p">,</span> <span class="n">Model</span><span class="p">.</span><span class="n">Controller</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">page</span> <span class="p">=</span> <span class="n">page</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span> <span class="p">},</span> <span class="n">Model</span><span class="p">.</span><span class="n">AjaxOptions</span><span class="p">)%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span> <span class="p">}</span> <span class="k">if</span> <span class="p">(</span><span class="n">page</span> <span class="p">!=</span> <span class="n">Model</span><span class="p">.</span><span class="n">GetLastPageToLink</span><span class="p">())</span> <span class="p">{</span> <span class="p">%&gt;</span> <span class="p">|</span> <span class="p">&lt;%</span> <span class="p">}</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span> <span class="k">if</span> <span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">GetLastPageToLink</span><span class="p">()</span> <span class="p">!=</span> <span class="n">Model</span><span class="p">.</span><span class="n">PageCount</span><span class="p">)</span> <span class="p">{</span> <span class="p">%&gt;...&lt;%</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span> <span class="k">if</span> <span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">HasNextPage</span><span class="p">)</span> <span class="p">{</span> <span class="p">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%=</span> <span class="n">Ajax</span><span class="p">.</span><span class="n">ActionLink</span><span class="p">(</span><span class="s">&quot;Next&quot;</span><span class="p">,</span> <span class="n">Model</span><span class="p">.</span><span class="n">Action</span><span class="p">,</span> <span class="n">Model</span><span class="p">.</span><span class="n">Controller</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">page</span> <span class="p">=</span> <span class="p">(</span><span class="n">Model</span><span class="p">.</span><span class="n">PageIndex</span> <span class="p">+</span> <span class="m">1</span><span class="p">).</span><span class="n">ToString</span><span class="p">()</span> <span class="p">},</span> <span class="n">Model</span><span class="p">.</span><span class="n">AjaxOptions</span><span class="p">)%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;%</span> <span class="p">}</span> <span class="p">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The big difference here is the way that the links are generated. The original control simply creates an anchor tag and passes in the url generated by the Model. The AJAX control uses AJAX.ActionLink() instead, so we can have the link support AJAX.</p>

<p>So knowing how the control looks, this is the Model for the AJAX control itself:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">AjaxPaginationViewData</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="n">NumberOfPagesToEachSide</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="n">PageIndex</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="n">PageSize</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="n">TotalCount</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">string</span> <span class="n">Action</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">string</span> <span class="n">Controller</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="n">AjaxOptions</span> <span class="n">AjaxOptions</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="n">PageCount</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">get</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">Math</span><span class="p">.</span><span class="n">Ceiling</span><span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="n">TotalCount</span> <span class="p">/</span> <span class="n">PageSize</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">bool</span> <span class="n">HasPreviousPage</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">get</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="p">(</span><span class="n">PageIndex</span> <span class="p">&gt;</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">bool</span> <span class="n">HasNextPage</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">get</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="p">(</span><span class="n">PageIndex</span> <span class="p">*</span> <span class="n">PageSize</span><span class="p">)</span> <span class="p">&lt;=</span> <span class="n">TotalCount</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="nf">GetFirstPageToLink</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">(</span><span class="n">PageIndex</span> <span class="p">-</span> <span class="n">NumberOfPagesToEachSide</span> <span class="p">&gt;</span> <span class="m">1</span> <span class="p">?</span> <span class="n">PageIndex</span> <span class="p">-</span> <span class="n">NumberOfPagesToEachSide</span> <span class="p">:</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="nf">GetLastPageToLink</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">(</span><span class="n">PageIndex</span> <span class="p">+</span> <span class="n">NumberOfPagesToEachSide</span> <span class="p">&lt;</span> <span class="n">PageCount</span> <span class="p">?</span> <span class="n">PageIndex</span> <span class="p">+</span> <span class="n">NumberOfPagesToEachSide</span> <span class="p">:</span> <span class="n">PageCount</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>That pretty much explains how the control is built.</p>

<p>The only thing left is how the interaction with PagedList happens.  For that we look at the action that the control calls.  In this example, we’re calling SomeAction in SomeController, and it would look something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">SomeAction</span><span class="p">(</span><span class="kt">int</span> <span class="n">page</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">CachedPage</span> <span class="p">=</span> <span class="n">page</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">var</span> <span class="n">query</span> <span class="p">=</span> <span class="n">GetSearchQuery</span><span class="p">(</span><span class="n">CachedSearchParameters</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">var</span> <span class="n">model</span> <span class="p">=</span> <span class="n">query</span><span class="p">.</span><span class="n">ToPagedList</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">DefaultPageSize</span><span class="p">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="nf">PartialView</span><span class="p">(</span><span class="s">&quot;AjaxResults&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The ToPagedList performs the functionality that is included with the PagedList classes which you can find <a href="http://pagedlist.codeplex.com/">here</a>.</p>

<p>Let me know what you think, and if you’d like some demo source to see this in action I can happily provide, just let me know.</p>
</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>


</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2014 - Joseph Bulger -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





		</div>
	</div>
</body>
</html>
